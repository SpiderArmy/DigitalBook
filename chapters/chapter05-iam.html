<!DOCTYPE html>
<html>
<head>
<title>chapter05-iam.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="chapter-5-identity-and-access-management">Chapter 5: Identity and Access Management</h1>
<h2 id="%F0%9F%8E%AF-learning-objectives">üéØ Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>Understand the fundamental concepts of identity and access management (IAM)</li>
<li>Explain the difference between authentication, authorization, and accounting (AAA)</li>
<li>Deploy and configure Active Directory and OpenLDAP systems</li>
<li>Implement Single Sign-On (SSO) solutions using OpenAM and federation standards</li>
<li>Design and implement Role-Based Access Control (RBAC) and Attribute-Based Access Control (ABAC)</li>
<li>Understand SAML, OAuth, and OpenID Connect protocols</li>
<li>Implement access governance and attestation processes</li>
<li>Monitor and audit access activities for security compliance</li>
</ul>
<h2 id="%F0%9F%94%90-what-is-identity-and-access-management">üîê What is Identity and Access Management?</h2>
<p>Identity and Access Management (IAM) is a framework of policies, processes, and technologies that ensures the right individuals have access to the right resources at the right times for the right reasons. IAM is fundamental to cybersecurity as it controls who can access what within an organization.</p>
<h3 id="the-iam-challenge">The IAM Challenge</h3>
<p>Organizations face a complex challenge: <strong>providing seamless access to legitimate users while preventing unauthorized access from attackers</strong>. This becomes increasingly difficult as organizations grow, adopt cloud services, and face sophisticated threats.</p>
<h3 id="why-iam-matters">Why IAM Matters</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[IAM Benefits] --> B[Security]
    A --> C[Compliance]
    A --> D[Efficiency]
    A --> E[Risk Management]
    
    B --> B1[Prevent unauthorized access]
    B --> B2[Reduce insider threats]
    B --> B3[Protect sensitive data]
    
    C --> C1[Meet regulatory requirements]
    C --> C2[Audit trail compliance]
    C --> C3[Data protection standards]
    
    D --> D1[Streamlined user access]
    D --> D2[Automated provisioning]
    D --> D3[Self-service capabilities]
    
    E --> E1[Access risk assessment]
    E --> E2[Privilege escalation control]
    E --> E3[Continuous monitoring]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h2 id="%F0%9F%94%91-the-aaa-framework-authentication-authorization-and-accounting">üîë The AAA Framework: Authentication, Authorization, and Accounting</h2>
<p>The AAA framework provides the foundation for secure access control systems.</p>
<h3 id="aaa-components">AAA Components</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[AAA Framework] --> B[Authentication]
    A --> C[Authorization]
    A --> D[Accounting]
    
    B --> B1[Who are you?]
    B --> B2[Verify identity]
    B --> B3[Multi-factor methods]
    
    C --> C1[What can you access?]
    C --> C2[Resource permissions]
    C --> C3[Access policies]
    
    D --> D1[What did you do?]
    D --> D2[Activity logging]
    D --> D3[Audit trails]
    
    B1 --> E1[Username/password]
    B1 --> E2[Biometrics]
    B1 --> E3[Smart cards]
    
    C1 --> E4[Role-based access]
    C1 --> E5[Attribute-based access]
    C1 --> E6[Time-based restrictions]
    
    D1 --> E7[Login/logout events]
    D1 --> E8[Resource access]
    D1 --> E9[Policy violations]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E1 fill:#e8f5e8
    style E2 fill:#e8f5e8
    style E3 fill:#e8f5e8
    style E4 fill:#fff3e0
    style E5 fill:#fff3e0
    style E6 fill:#fff3e0
    style E7 fill:#fce4ec
    style E8 fill:#fce4ec
    style E9 fill:#fce4ec
</div></code></pre>
<h3 id="1-authentication-who-are-you">1. <strong>Authentication (Who are you?)</strong></h3>
<p>Authentication verifies the identity of users attempting to access systems or resources.</p>
<h4 id="authentication-factors">Authentication Factors</h4>
<p><strong>Something You Know</strong>:</p>
<ul>
<li>Passwords, PINs, security questions</li>
<li><strong>Strengths</strong>: Easy to implement, familiar to users</li>
<li><strong>Weaknesses</strong>: Can be guessed, shared, or stolen</li>
</ul>
<p><strong>Something You Have</strong>:</p>
<ul>
<li>Smart cards, security tokens, mobile devices</li>
<li><strong>Strengths</strong>: Hard to duplicate, can be revoked</li>
<li><strong>Weaknesses</strong>: Can be lost, stolen, or damaged</li>
</ul>
<p><strong>Something You Are</strong>:</p>
<ul>
<li>Fingerprints, facial recognition, voice patterns</li>
<li><strong>Strengths</strong>: Unique to individual, cannot be lost</li>
<li><strong>Weaknesses</strong>: Can be spoofed, affected by injury/illness</li>
</ul>
<h4 id="multi-factor-authentication-mfa">Multi-Factor Authentication (MFA)</h4>
<p>MFA requires users to provide multiple authentication factors, significantly improving security.</p>
<pre><code class="language-mermaid"><div class="mermaid">graph LR
    A[User Login] --> B[Username/Password]
    B --> C[Verification]
    C --> D[Second Factor]
    D --> E[Access Granted]
    
    B --> B1[Knowledge Factor]
    D --> D1[Possession Factor]
    D --> D2[Inherence Factor]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<p><strong>MFA Examples</strong>:</p>
<ul>
<li><strong>Password + SMS Code</strong>: Common but vulnerable to SIM swapping</li>
<li><strong>Password + Authenticator App</strong>: More secure, offline capability</li>
<li><strong>Password + Hardware Token</strong>: Highest security, physical device required</li>
</ul>
<h3 id="2-authorization-what-can-you-access">2. <strong>Authorization (What can you access?)</strong></h3>
<p>Authorization determines what resources and actions a user can access after successful authentication.</p>
<h4 id="access-control-models">Access Control Models</h4>
<p><strong>Discretionary Access Control (DAC)</strong>:</p>
<ul>
<li>Resource owners control access permissions</li>
<li>Flexible but can lead to permission proliferation</li>
<li>Example: File sharing in operating systems</li>
</ul>
<p><strong>Mandatory Access Control (MAC)</strong>:</p>
<ul>
<li>System-enforced access policies</li>
<li>Rigid but highly secure</li>
<li>Example: Military and government systems</li>
</ul>
<p><strong>Role-Based Access Control (RBAC)</strong>:</p>
<ul>
<li>Access based on user roles</li>
<li>Scalable and manageable</li>
<li>Example: Employee roles in organizations</li>
</ul>
<p><strong>Attribute-Based Access Control (ABAC)</strong>:</p>
<ul>
<li>Access based on user, resource, and environmental attributes</li>
<li>Highly flexible and context-aware</li>
<li>Example: Time-based access, location-based restrictions</li>
</ul>
<h3 id="3-accounting-what-did-you-do">3. <strong>Accounting (What did you do?)</strong></h3>
<p>Accounting tracks and logs all user activities for audit and security purposes.</p>
<h4 id="logging-requirements">Logging Requirements</h4>
<ul>
<li><strong>Authentication Events</strong>: Login attempts, successes, failures</li>
<li><strong>Authorization Events</strong>: Resource access, permission changes</li>
<li><strong>User Activities</strong>: Commands executed, data accessed, changes made</li>
<li><strong>System Events</strong>: Configuration changes, security events</li>
</ul>
<h2 id="%F0%9F%8F%A2-active-directory-microsofts-directory-service">üè¢ Active Directory: Microsoft's Directory Service</h2>
<p>Active Directory (AD) is Microsoft's directory service that provides centralized authentication and authorization for Windows networks.</p>
<h3 id="what-is-active-directory">What is Active Directory?</h3>
<p>Active Directory is a hierarchical directory service that stores information about network resources, including users, computers, groups, and organizational units (OUs).</p>
<h3 id="active-directory-structure">Active Directory Structure</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[Forest] --> B[Domain Tree]
    B --> C[Domain]
    C --> D[Organizational Unit]
    D --> E[Users]
    D --> F[Computers]
    D --> G[Groups]
    
    B --> B1[contoso.com]
    B --> B2[us.contoso.com]
    B --> B3[eu.contoso.com]
    
    C --> C1[Domain Controllers]
    C --> C2[Member Servers]
    C --> C3[Workstations]
    
    D --> D1[Sales OU]
    D --> D2[IT OU]
    D --> D3[Finance OU]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
    style F fill:#f1f8e9
    style G fill:#fff8e1
</div></code></pre>
<h3 id="active-directory-components">Active Directory Components</h3>
<h4 id="1-forest">1. <strong>Forest</strong></h4>
<ul>
<li>Top-level container for AD objects</li>
<li>Contains one or more domains</li>
<li>Establishes trust relationships</li>
</ul>
<h4 id="2-domain">2. <strong>Domain</strong></h4>
<ul>
<li>Logical grouping of AD objects</li>
<li>Has its own security policies</li>
<li>Can contain multiple OUs</li>
</ul>
<h4 id="3-organizational-unit-ou">3. <strong>Organizational Unit (OU)</strong></h4>
<ul>
<li>Container for organizing AD objects</li>
<li>Can have Group Policy applied</li>
<li>Enables delegation of administration</li>
</ul>
<h4 id="4-domain-controllers">4. <strong>Domain Controllers</strong></h4>
<ul>
<li>Servers that authenticate users</li>
<li>Store AD database</li>
<li>Replicate changes to other DCs</li>
</ul>
<h3 id="active-directory-security-features">Active Directory Security Features</h3>
<h4 id="group-policy">Group Policy</h4>
<p>Group Policy allows administrators to centrally manage user and computer settings.</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Example Group Policy Settings</span>
Computer Configuration:
- Password policies
- Account lockout policies
- Security settings
- Software installation

User Configuration:
- Desktop settings
- Application restrictions
- Folder redirection
- Scripts
</div></code></pre>
<h4 id="trust-relationships">Trust Relationships</h4>
<p>Trusts enable users in one domain to access resources in another domain.</p>
<p><strong>Trust Types</strong>:</p>
<ul>
<li><strong>One-Way Trust</strong>: Domain A trusts Domain B, but not vice versa</li>
<li><strong>Two-Way Trust</strong>: Both domains trust each other</li>
<li><strong>Transitive Trust</strong>: Trust extends through multiple domains</li>
</ul>
<h3 id="active-directory-deployment">Active Directory Deployment</h3>
<h4 id="installation-steps">Installation Steps</h4>
<ol>
<li>
<p><strong>Prepare the Environment</strong></p>
<ul>
<li>Ensure DNS is properly configured</li>
<li>Verify network connectivity</li>
<li>Plan domain structure</li>
</ul>
</li>
<li>
<p><strong>Install Active Directory Domain Services</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Install AD DS role</span>
Install-WindowsFeature -Name AD-Domain-Services

<span class="hljs-comment"># Promote to Domain Controller</span>
Install-ADDSForest -DomainName <span class="hljs-string">"contoso.com"</span>
</div></code></pre>
</li>
<li>
<p><strong>Configure Domain Settings</strong></p>
<ul>
<li>Set password policies</li>
<li>Configure account lockout policies</li>
<li>Establish security baselines</li>
</ul>
</li>
</ol>
<h4 id="security-best-practices">Security Best Practices</h4>
<ul>
<li><strong>Regular Backups</strong>: Backup AD database and system state</li>
<li><strong>Monitoring</strong>: Monitor for suspicious activities</li>
<li><strong>Patching</strong>: Keep domain controllers updated</li>
<li><strong>Access Control</strong>: Limit administrative access</li>
</ul>
<h2 id="%F0%9F%90%A7-openldap-open-source-directory-service">üêß OpenLDAP: Open Source Directory Service</h2>
<p>OpenLDAP is an open-source implementation of the Lightweight Directory Access Protocol (LDAP), providing directory services for various platforms.</p>
<h3 id="what-is-ldap">What is LDAP?</h3>
<p>LDAP is a protocol for accessing and managing directory information. It's platform-independent and widely used for authentication and directory services.</p>
<h3 id="ldap-vs-active-directory">LDAP vs Active Directory</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>OpenLDAP</th>
<th>Active Directory</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Platform</strong></td>
<td>Cross-platform</td>
<td>Windows-centric</td>
</tr>
<tr>
<td><strong>Cost</strong></td>
<td>Free, open-source</td>
<td>Licensing required</td>
</tr>
<tr>
<td><strong>Integration</strong></td>
<td>Standards-based</td>
<td>Microsoft ecosystem</td>
</tr>
<tr>
<td><strong>Management</strong></td>
<td>Command-line, web tools</td>
<td>GUI management tools</td>
</tr>
<tr>
<td><strong>Scalability</strong></td>
<td>Highly scalable</td>
<td>Enterprise-scale</td>
</tr>
</tbody>
</table>
<h3 id="openldap-structure">OpenLDAP Structure</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[LDAP Directory] --> B[dc=example,dc=com]
    B --> C[ou=People]
    B --> D[ou=Groups]
    B --> E[ou=Computers]
    
    C --> C1[uid=john]
    C --> C2[uid=jane]
    C --> C3[uid=bob]
    
    D --> D1[cn=Administrators]
    D --> D2[cn=Users]
    D --> D3[cn=Guests]
    
    E --> E1[cn=server1]
    E --> E2[cn=workstation1]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h3 id="openldap-installation-and-configuration">OpenLDAP Installation and Configuration</h3>
<h4 id="installation-ubuntudebian">Installation (Ubuntu/Debian)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Install OpenLDAP server</span>
sudo apt-get update
sudo apt-get install slapd ldap-utils

<span class="hljs-comment"># Configure basic settings</span>
sudo dpkg-reconfigure slapd
</div></code></pre>
<h4 id="basic-configuration">Basic Configuration</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># LDAP configuration file</span>
/etc/ldap/slapd.conf

<span class="hljs-comment"># Database configuration</span>
/etc/ldap/slapd.d/

<span class="hljs-comment"># Access control</span>
access to *
    by dn=<span class="hljs-string">"cn=admin,dc=example,dc=com"</span> write
    by * <span class="hljs-built_in">read</span>
</div></code></pre>
<h4 id="adding-users-and-groups">Adding Users and Groups</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Add user entry</span>
ldapadd -x -D <span class="hljs-string">"cn=admin,dc=example,dc=com"</span> -W
dn: uid=john,ou=People,dc=example,dc=com
objectClass: inetOrgPerson
uid: john
cn: John Doe
sn: Doe
mail: john@example.com

<span class="hljs-comment"># Add group entry</span>
ldapadd -x -D <span class="hljs-string">"cn=admin,dc=example,dc=com"</span> -W
dn: cn=Users,ou=Groups,dc=example,dc=com
objectClass: groupOfNames
cn: Users
member: uid=john,ou=People,dc=example,dc=com
</div></code></pre>
<h2 id="%F0%9F%94%97-single-sign-on-sso-implementation">üîó Single Sign-On (SSO) Implementation</h2>
<p>Single Sign-On allows users to authenticate once and access multiple applications without re-entering credentials.</p>
<h3 id="sso-benefits">SSO Benefits</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[SSO Benefits] --> B[User Experience]
    A --> C[Security]
    A --> D[Administration]
    A --> E[Compliance]
    
    B --> B1[Reduced password fatigue]
    B --> B2[Faster access]
    B --> B3[Consistent experience]
    
    C --> C1[Centralized authentication]
    C --> C2[Stronger passwords]
    C --> C3[Easier MFA implementation]
    
    D --> D1[Centralized user management]
    D --> D2[Reduced help desk calls]
    D --> D3[Automated provisioning]
    
    E --> E1[Audit trail compliance]
    E --> E2[Access policy enforcement]
    E --> E3[Regular access reviews]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h3 id="sso-architecture">SSO Architecture</h3>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant User
    participant App1
    participant App2
    participant SSO Service
    participant Directory
    
    User->>App1: Access request
    App1->>SSO Service: Check authentication
    SSO Service->>Directory: Verify user
    Directory-->>SSO Service: User valid
    SSO Service-->>App1: Authentication token
    App1-->>User: Access granted
    
    User->>App2: Access request
    App2->>SSO Service: Validate token
    SSO Service-->>App2: Token valid
    App2-->>User: Access granted
</div></code></pre>
<h3 id="openam-open-source-sso-solution">OpenAM: Open Source SSO Solution</h3>
<p>OpenAM is a comprehensive access management solution that provides SSO, federation, and access control capabilities.</p>
<h4 id="openam-features">OpenAM Features</h4>
<ul>
<li><strong>Single Sign-On</strong>: Access multiple applications with one login</li>
<li><strong>Federation</strong>: Share authentication across organizations</li>
<li><strong>Access Control</strong>: Fine-grained permission management</li>
<li><strong>Session Management</strong>: Secure session handling</li>
<li><strong>Audit Logging</strong>: Comprehensive activity tracking</li>
</ul>
<h4 id="openam-deployment">OpenAM Deployment</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Download OpenAM</span>
wget https://downloads.forgerock.org/openam/openam/14.0.0/openam-14.0.0.war

<span class="hljs-comment"># Deploy to application server</span>
cp openam-14.0.0.war /path/to/tomcat/webapps/

<span class="hljs-comment"># Configure OpenAM</span>
<span class="hljs-comment"># Access configuration wizard at http://server:port/openam</span>
</div></code></pre>
<h2 id="%F0%9F%94%90-federation-standards-saml-oauth-and-openid-connect">üîê Federation Standards: SAML, OAuth, and OpenID Connect</h2>
<p>Federation enables secure authentication and authorization across different organizations and systems.</p>
<h3 id="saml-security-assertion-markup-language">SAML (Security Assertion Markup Language)</h3>
<p>SAML is an XML-based standard for exchanging authentication and authorization data between parties.</p>
<h4 id="saml-components">SAML Components</h4>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[SAML Federation] --> B[Identity Provider IdP]
    A --> C[Service Provider SP]
    A --> D[User]
    
    B --> B1[Authenticates users]
    B --> B2[Issues SAML assertions]
    B --> B3[Manages user attributes]
    
    C --> C1[Provides services]
    C --> C2[Validates SAML assertions]
    C --> C3[Enforces access policies]
    
    D --> D1[Initiates access]
    D --> D2[Provides credentials]
    D --> D3[Receives service access]
    
    B --> E[SAML Response]
    E --> E1[Authentication statement]
    E --> E2[Attribute statement]
    E --> E3[Authorization decision]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h4 id="saml-flow">SAML Flow</h4>
<ol>
<li><strong>User</strong> requests access to Service Provider</li>
<li><strong>Service Provider</strong> redirects to Identity Provider</li>
<li><strong>Identity Provider</strong> authenticates user</li>
<li><strong>Identity Provider</strong> sends SAML assertion to Service Provider</li>
<li><strong>Service Provider</strong> validates assertion and grants access</li>
</ol>
<h3 id="oauth-20">OAuth 2.0</h3>
<p>OAuth 2.0 is an authorization framework that allows third-party applications to access resources on behalf of users.</p>
<h4 id="oauth-20-roles">OAuth 2.0 Roles</h4>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[OAuth 2.0 Flow] --> B[Resource Owner]
    A --> C[Client Application]
    A --> D[Authorization Server]
    A --> E[Resource Server]
    
    B --> B1[User with resources]
    B --> B2[Grants permission]
    
    C --> C1[Third-party app]
    C --> C2[Requests access]
    C --> C3[Uses access token]
    
    D --> D1[Issues tokens]
    D --> D2[Manages permissions]
    
    E --> E1[Hosts resources]
    E --> E2[Validates tokens]
    
    B --> F[Authorization Grant]
    F --> D
    D --> G[Access Token]
    G --> C
    C --> H[Protected Resource]
    H --> E
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
    style F fill:#e8f5e8
    style G fill:#fff3e0
    style H fill:#fce4ec
</div></code></pre>
<h4 id="oauth-20-grant-types">OAuth 2.0 Grant Types</h4>
<ul>
<li><strong>Authorization Code</strong>: Most secure, for web applications</li>
<li><strong>Implicit</strong>: Less secure, for mobile/JavaScript apps</li>
<li><strong>Client Credentials</strong>: For machine-to-machine communication</li>
<li><strong>Resource Owner Password</strong>: For trusted applications</li>
</ul>
<h3 id="openid-connect">OpenID Connect</h3>
<p>OpenID Connect extends OAuth 2.0 to provide authentication information, not just authorization.</p>
<h4 id="openid-connect-benefits">OpenID Connect Benefits</h4>
<ul>
<li><strong>Standardized</strong>: Industry-standard authentication protocol</li>
<li><strong>Secure</strong>: Built on OAuth 2.0 security model</li>
<li><strong>Flexible</strong>: Supports various authentication methods</li>
<li><strong>Interoperable</strong>: Works across different platforms</li>
</ul>
<h2 id="%F0%9F%8E%AD-access-control-models-rbac-and-abac">üé≠ Access Control Models: RBAC and ABAC</h2>
<h3 id="role-based-access-control-rbac">Role-Based Access Control (RBAC)</h3>
<p>RBAC assigns permissions to roles rather than directly to users, simplifying access management.</p>
<h4 id="rbac-components">RBAC Components</h4>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[RBAC Model] --> B[Users]
    A --> C[Roles]
    A --> D[Permissions]
    A --> E[Resources]
    
    B --> B1[John Doe]
    B --> B2[Jane Smith]
    B --> B3[Bob Johnson]
    
    C --> C1[Administrator]
    C --> C2[Manager]
    C --> C3[Employee]
    
    D --> D1[Read]
    D --> D2[Write]
    D --> D3[Delete]
    D --> D4[Execute]
    
    E --> E1[Files]
    E --> E2[Databases]
    E --> E3[Applications]
    
    B --> F[User Assignment]
    F --> C
    C --> G[Permission Assignment]
    G --> D
    D --> H[Resource Access]
    H --> E
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
    style F fill:#e8f5e8
    style G fill:#fff3e0
    style H fill:#fce4ec
</div></code></pre>
<h4 id="rbac-implementation-example">RBAC Implementation Example</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Define roles</span>
role Administrator {
    permissions: [<span class="hljs-string">"read"</span>, <span class="hljs-string">"write"</span>, <span class="hljs-string">"delete"</span>, <span class="hljs-string">"execute"</span>]
    resources: [<span class="hljs-string">"*"</span>]
}

role Manager {
    permissions: [<span class="hljs-string">"read"</span>, <span class="hljs-string">"write"</span>]
    resources: [<span class="hljs-string">"/data/sales/*"</span>, <span class="hljs-string">"/reports/*"</span>]
}

role Employee {
    permissions: [<span class="hljs-string">"read"</span>]
    resources: [<span class="hljs-string">"/data/sales/own/*"</span>]
}

<span class="hljs-comment"># Assign users to roles</span>
assign john.doe to Administrator
assign jane.smith to Manager
assign bob.johnson to Employee
</div></code></pre>
<h3 id="attribute-based-access-control-abac">Attribute-Based Access Control (ABAC)</h3>
<p>ABAC makes access decisions based on attributes of users, resources, actions, and environment.</p>
<h4 id="abac-attributes">ABAC Attributes</h4>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[ABAC Decision] --> B[User Attributes]
    A --> C[Resource Attributes]
    A --> D[Action Attributes]
    A --> E[Environment Attributes]
    
    B --> B1[Department]
    B --> B2[Security Clearance]
    B --> B3[Location]
    B --> B4[Time of Day]
    
    C --> C1[Classification]
    C --> C2[Owner]
    C --> C3[Location]
    C --> C4[Data Type]
    
    D --> D1[Operation]
    D --> D2[Risk Level]
    D --> D3[Audit Required]
    
    E --> E1[Time]
    E --> E2[Location]
    E --> E3[Network]
    E --> E4[Device Type]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h4 id="abac-policy-example">ABAC Policy Example</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Policy: Allow managers to read sales data during business hours</span>
policy <span class="hljs-string">"Sales Data Access"</span> {
    effect: <span class="hljs-string">"allow"</span>
    condition: {
        user.department == <span class="hljs-string">"Sales"</span> AND
        user.role == <span class="hljs-string">"Manager"</span> AND
        resource.type == <span class="hljs-string">"Sales Data"</span> AND
        action == <span class="hljs-string">"read"</span> AND
        time.hour &gt;= 8 AND time.hour &lt;= 18
    }
}
</div></code></pre>
<h2 id="%F0%9F%93%8A-access-governance-and-attestation">üìä Access Governance and Attestation</h2>
<p>Access governance ensures that user access remains appropriate over time through regular reviews and attestations.</p>
<h3 id="access-governance-process">Access Governance Process</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[Access Governance] --> B[Access Review]
    A --> C[Access Certification]
    A --> D[Access Remediation]
    A --> E[Continuous Monitoring]
    
    B --> B1[Regular reviews]
    B --> B2[Manager approval]
    B --> B3[Risk assessment]
    
    C --> C1[Formal certification]
    C --> C2[Documentation]
    C --> C3[Audit trail]
    
    D --> D1[Remove access]
    D --> D2[Modify permissions]
    D --> D3[Update roles]
    
    E --> E1[Real-time monitoring]
    E --> E2[Anomaly detection]
    E --> E3[Policy enforcement]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h3 id="access-review-workflow">Access Review Workflow</h3>
<ol>
<li>
<p><strong>Identify Review Scope</strong></p>
<ul>
<li>High-privilege accounts</li>
<li>Critical system access</li>
<li>Dormant accounts</li>
<li>Role changes</li>
</ul>
</li>
<li>
<p><strong>Conduct Reviews</strong></p>
<ul>
<li>Manager reviews direct reports</li>
<li>System owners review access</li>
<li>Security team reviews privileged access</li>
</ul>
</li>
<li>
<p><strong>Document Decisions</strong></p>
<ul>
<li>Approve access</li>
<li>Revoke unnecessary access</li>
<li>Modify permissions</li>
<li>Escalate exceptions</li>
</ul>
</li>
<li>
<p><strong>Implement Changes</strong></p>
<ul>
<li>Automated provisioning</li>
<li>Manual updates</li>
<li>Verification of changes</li>
</ul>
</li>
</ol>
<h3 id="access-attestation-tools">Access Attestation Tools</h3>
<h4 id="manual-attestation">Manual Attestation</h4>
<ul>
<li>Spreadsheet-based reviews</li>
<li>Email notifications</li>
<li>Manual approval workflows</li>
</ul>
<h4 id="automated-attestation">Automated Attestation</h4>
<ul>
<li>Identity governance platforms</li>
<li>Workflow automation</li>
<li>Integration with HR systems</li>
<li>Automated provisioning</li>
</ul>
<h2 id="%F0%9F%94%8D-monitoring-and-auditing-access">üîç Monitoring and Auditing Access</h2>
<p>Continuous monitoring and auditing of access activities is essential for security and compliance.</p>
<h3 id="access-monitoring-components">Access Monitoring Components</h3>
<pre><code class="language-mermaid"><div class="mermaid">graph TD
    A[Access Monitoring] --> B[Authentication Monitoring]
    A --> C[Authorization Monitoring]
    A --> D[Privilege Monitoring]
    A --> E[Behavioral Analysis]
    
    B --> B1[Login attempts]
    B --> B2[Failed authentications]
    B --> B3[Multi-factor usage]
    
    C --> C1[Resource access]
    C --> C2[Permission changes]
    C --> C3[Policy violations]
    
    D --> D1[Privilege escalation]
    D --> D2[Administrative actions]
    D --> D3[Sudo usage]
    
    E --> E1[User behavior patterns]
    E --> E2[Anomaly detection]
    E --> E3[Risk scoring]
    
    style A fill:#e3f2fd
    style B fill:#f3e5f5
    style C fill:#e8f5e8
    style D fill:#fff3e0
    style E fill:#fce4ec
</div></code></pre>
<h3 id="key-monitoring-metrics">Key Monitoring Metrics</h3>
<h4 id="authentication-metrics">Authentication Metrics</h4>
<ul>
<li><strong>Failed login attempts</strong>: Detect brute force attacks</li>
<li><strong>Successful logins</strong>: Track user activity patterns</li>
<li><strong>Multi-factor usage</strong>: Ensure MFA compliance</li>
<li><strong>Account lockouts</strong>: Identify attack patterns</li>
</ul>
<h4 id="authorization-metrics">Authorization Metrics</h4>
<ul>
<li><strong>Resource access patterns</strong>: Understand usage</li>
<li><strong>Permission changes</strong>: Track administrative actions</li>
<li><strong>Policy violations</strong>: Identify security issues</li>
<li><strong>Access denials</strong>: Detect unauthorized attempts</li>
</ul>
<h4 id="privilege-metrics">Privilege Metrics</h4>
<ul>
<li><strong>Privilege escalation</strong>: Monitor administrative access</li>
<li><strong>Sudo usage</strong>: Track elevated privileges</li>
<li><strong>Role changes</strong>: Monitor permission modifications</li>
<li><strong>Emergency access</strong>: Track break-glass procedures</li>
</ul>
<h3 id="audit-logging-requirements">Audit Logging Requirements</h3>
<h4 id="what-to-log">What to Log</h4>
<ul>
<li><strong>User identification</strong>: Who performed the action</li>
<li><strong>Action performed</strong>: What was done</li>
<li><strong>Resource accessed</strong>: What was affected</li>
<li><strong>Timestamp</strong>: When it occurred</li>
<li><strong>Source location</strong>: Where it came from</li>
<li><strong>Result</strong>: Success or failure</li>
</ul>
<h4 id="log-retention">Log Retention</h4>
<ul>
<li><strong>Authentication logs</strong>: 1-2 years minimum</li>
<li><strong>Access logs</strong>: 3-7 years for compliance</li>
<li><strong>Administrative logs</strong>: 7+ years for audit</li>
<li><strong>Security events</strong>: Permanent retention</li>
</ul>
<h2 id="%F0%9F%A7%AA-hands-on-activities">üß™ Hands-on Activities</h2>
<h3 id="activity-1-active-directory-setup">Activity 1: Active Directory Setup</h3>
<p><strong>Objective</strong>: Deploy and configure Active Directory in a lab environment.</p>
<p><strong>Materials</strong>: Windows Server VM, client workstations</p>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>Install Windows Server</strong> and configure networking</li>
<li><strong>Install Active Directory Domain Services</strong></li>
<li><strong>Promote server to Domain Controller</strong></li>
<li><strong>Create organizational units</strong> for different departments</li>
<li><strong>Add users and groups</strong> with appropriate permissions</li>
<li><strong>Configure Group Policy</strong> for security settings</li>
<li><strong>Join client workstations</strong> to the domain</li>
</ol>
<h3 id="activity-2-openldap-configuration">Activity 2: OpenLDAP Configuration</h3>
<p><strong>Objective</strong>: Set up OpenLDAP directory service with user management.</p>
<p><strong>Materials</strong>: Linux VM, LDAP client tools</p>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>Install OpenLDAP</strong> server and utilities</li>
<li><strong>Configure basic LDAP settings</strong> and database</li>
<li><strong>Create organizational structure</strong> (OUs, users, groups)</li>
<li><strong>Configure access control</strong> policies</li>
<li><strong>Test authentication</strong> with LDAP clients</li>
<li><strong>Implement password policies</strong> and security</li>
</ol>
<h3 id="activity-3-sso-implementation">Activity 3: SSO Implementation</h3>
<p><strong>Objective</strong>: Implement Single Sign-On using OpenAM or similar solution.</p>
<p><strong>Materials</strong>: Application server, OpenAM, sample applications</p>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>Deploy OpenAM</strong> to application server</li>
<li><strong>Configure identity provider</strong> settings</li>
<li><strong>Set up service providers</strong> for applications</li>
<li><strong>Configure federation</strong> between systems</li>
<li><strong>Test SSO functionality</strong> across applications</li>
<li><strong>Implement access control</strong> policies</li>
</ol>
<h3 id="activity-4-access-control-design">Activity 4: Access Control Design</h3>
<p><strong>Objective</strong>: Design and implement RBAC and ABAC models.</p>
<p><strong>Scenario</strong>: University with different user types and access requirements</p>
<p><strong>Requirements</strong>:</p>
<ul>
<li><strong>Students</strong>: Access to course materials, limited library resources</li>
<li><strong>Faculty</strong>: Access to course management, research databases</li>
<li><strong>Staff</strong>: Access to administrative systems, student records</li>
<li><strong>Administrators</strong>: Full system access with monitoring</li>
</ul>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>Define user roles</strong> and responsibilities</li>
<li><strong>Identify resources</strong> and access requirements</li>
<li><strong>Design permission matrix</strong> for each role</li>
<li><strong>Implement access controls</strong> in directory service</li>
<li><strong>Test access patterns</strong> and verify security</li>
<li><strong>Document access policies</strong> and procedures</li>
</ol>
<h2 id="%F0%9F%93%8B-key-takeaways">üìã Key Takeaways</h2>
<ol>
<li>
<p><strong>IAM is fundamental</strong> to cybersecurity, controlling who can access what resources and when.</p>
</li>
<li>
<p><strong>The AAA framework</strong> provides the foundation for secure access control systems.</p>
</li>
<li>
<p><strong>Directory services</strong> like Active Directory and OpenLDAP centralize user management and authentication.</p>
</li>
<li>
<p><strong>Single Sign-On</strong> improves user experience while maintaining security through centralized authentication.</p>
</li>
<li>
<p><strong>Federation standards</strong> enable secure authentication across organizational boundaries.</p>
</li>
<li>
<p><strong>Access governance</strong> ensures that user access remains appropriate through regular reviews and monitoring.</p>
</li>
<li>
<p><strong>Continuous monitoring</strong> and auditing are essential for detecting security threats and maintaining compliance.</p>
</li>
</ol>
<h2 id="%E2%9D%93-review-questions">‚ùì Review Questions</h2>
<ol>
<li>
<p><strong>What are the three components</strong> of the AAA framework, and how do they work together?</p>
</li>
<li>
<p><strong>How does Active Directory</strong> differ from OpenLDAP, and when would you choose each?</p>
</li>
<li>
<p><strong>What are the benefits</strong> of implementing Single Sign-On, and what are the security considerations?</p>
</li>
<li>
<p><strong>How do RBAC and ABAC</strong> differ, and what are the advantages of each approach?</p>
</li>
<li>
<p><strong>What is access governance</strong>, and why is it important for security and compliance?</p>
</li>
</ol>
<h2 id="%F0%9F%93%9A-further-reading">üìö Further Reading</h2>
<h3 id="books">Books</h3>
<ul>
<li>&quot;Identity Management: A Business Perspective&quot; by Graham Williamson</li>
<li>&quot;Active Directory: Designing, Deploying, and Running Active Directory&quot; by Brian Desmond</li>
<li>&quot;LDAP System Administration&quot; by Gerald Carter</li>
</ul>
<h3 id="online-resources">Online Resources</h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/">Microsoft Active Directory Documentation</a></li>
<li><a href="https://www.openldap.org/doc/">OpenLDAP Documentation</a></li>
<li><a href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-tech-overview-2.0.html">SAML 2.0 Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 Framework</a></li>
</ul>
<h3 id="tools-and-platforms">Tools and Platforms</h3>
<ul>
<li><a href="https://www.forgerock.com/platform/access-management/">OpenAM</a></li>
<li><a href="https://www.keycloak.org/">Keycloak</a> - Open source identity and access management</li>
<li><a href="https://www.freeipa.org/">FreeIPA</a> - Identity, policy, and audit solution</li>
</ul>
<hr>
<p><strong>Next Chapter</strong>: <a href="chapter06-security-architecture.md">Chapter 6: Security Architecture and Threat Modeling</a> - Learn how to design secure systems using proven frameworks and methodologies.</p>

</body>
</html>
